<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Main</title>
	</head>
	<body>
		<div id="main"></div>
		<script type="text/javascript" src="/elm.js"></script>
		<script>
			var jwt = localStorage.getItem('jwt');
			var wsUrl = "ws://" + window.location.host;

			var options = {
				jwt: jwt,
				wsUrl: wsUrl
			}
			var node = document.getElementById('main');
			var app = Elm.Main.embed(node, options);

			app.ports.setJwt.subscribe( function(newJwt) {
				localStorage.setItem('jwt', newJwt)
			});

			app.ports.removeJwt.subscribe( function() {
				localStorage.removeItem('jwt')
			})

			app.ports.getJwt
		</script>
	</body>
	</html>